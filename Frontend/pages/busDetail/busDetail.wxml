<!-- pages/busDetail/busDetail.wxml -->
<view class="container">
  <view class="line-info">
    <text class="line-name">{{lineInfo.bus_staname}}</text>
    <text>起点站：{{lineInfo.sta_sta}}</text>
    <text>终点站：{{lineInfo.end_sta}}</text>
    <text>首班车：{{lineInfo.fir_time}}</text>
    <text>末班车：{{lineInfo.end_time}}</text>
    <text>票价：{{lineInfo.bus_money}}</text>
  </view>

  <map id="busMap" class="map"
       longitude="{{longitude}}"
       latitude="{{latitude}}"
       scale="13"
       markers="{{mapMarkers}}"
       polyline="{{polyline}}"
       bindmarkertap="onMarkerTap">
  </map>

  <view class="station-list">
    <text class="title">站点列表</text>
    <block wx:for="{{stations}}" wx:key="sid">
      <view class="station-item">
        <text>{{index + 1}}. {{item.bus_staname}}</text>
        <view class="bus-info">
          <!-- 显示车辆当前位置 -->
          <block wx:if="{{item.buses && item.buses.length > 0}}">
            <block wx:for="{{item.buses}}" wx:key="busId">
              <text class="bus-status">🚍 距离下一站 {{item.buses[0].distance}} 米</text>
            </block>
          </block>
          <!-- 显示车辆已通过 -->
          <block wx:elif="{{item.busPassed}}">
            <text class="bus-passed">已通过</text>
          </block>
        </view>
      </view>
    </block>
  </view>
</view>
